var browserTesting="click",storage=localStorage;if(void 0==storage.getItem("highestLevel")&&storage.setItem("highestLevel",0),void 0==storage.getItem("changeLevel"))storage.setItem("changeLevel",0);else if(1!=storage.getItem("changeLevel")){if(0!=storage.getItem("highestLevel"))var lvl="level_"+storage.getItem("highestLevel")+".html";else var lvl="index.html";var checkPage=window.location.href,checkLvl=checkPage.substring(checkPage.indexOf("level_")+6,checkPage.lastIndexOf("."));isNaN(checkLvl.trim())&&(checkLvl=0),console.log(checkLvl,storage.getItem("highestLevel")),checkLvl!=storage.getItem("highestLevel")&&(window.location.href=lvl)}else{if(0!=storage.getItem("highestLevel"))var lvl="level_"+storage.getItem("highestLevel")+".html";else var lvl="index.html";var checkPage=window.location.href,checkLvl=checkPage.substring(checkPage.indexOf("level_")+6,checkPage.lastIndexOf("."));isNaN(checkLvl.trim())&&(checkLvl=0),console.log(11111+checkLvl,storage.getItem("highestLevel")),parseInt(checkLvl)>parseInt(storage.getItem("highestLevel"))&&(window.location.href="index.html")}var checkPage=window.location.href,checkLvl=checkPage.substring(checkPage.indexOf("level_")+6,checkPage.lastIndexOf("."));if(isNaN(checkLvl.trim())&&(checkLvl=0),0!=checkLvl){var u="stepsLevel_"+checkLvl;void 0==storage.getItem(u)&&storage.setItem(u,0)}$(function(){function e(e,t,s){var t=t,s=s;e=parseInt(e);var a=new Array;a.push(e-s),a.push(e+s),e%s!=1&&a.push(e-1),e%s!=0&&a.push(e+1);for(var r=new Array,o=0;o<a.length;o++)("x"==t[a[o]-1]||"R"==t[a[o]-1]||a[o]<1||a[o]>t.length)&&-1==r.indexOf(a[o])&&r.push(a[o]);for(var o=0;o<r.length;o++)a.splice(a.indexOf(r[o]),1);for(var o=0;o<a.length;o++)$("#chessboard td[data-pos='"+a[o]+"']").addClass("movableGreenSpaces")}function t(e,t,s,a){var t=t;e=parseInt(e);var r=$("#chessboard tr td.teleBox").attr("data-pos");r=parseInt(r);var o=$("#chessboard tr td.teleBoxGOTO").attr("data-pos");o=parseInt(o),r==e&&(t[e-1]="0","B"==a?(t[o-1]="B",$("#chessboardInput").val(t.join("")),$('#chessboard tr td[data-pos="'+e+'"]').removeClass("bluePlayer"),$("#chessboard tr td").removeClass("movableGreenSpaces"),$('#chessboard tr td[data-pos="'+o+'"]').addClass("bluePlayer")):(t[o-1]="R",$("#chessboardInput").val(t.join("")),$('#chessboard tr td[data-pos="'+e+'"]').removeClass("redPlayer"),$('#chessboard tr td[data-pos="'+o+'"]').addClass("redPlayer")),$("#chessboard tr td").removeClass("teleBox"),$("#chessboard tr td.teleBoxGOTO span").hide())}function s(e){b++,$(".curSteps").html(b);var t=$("#chessboardInput").val();t=t.split(/\r\n|\r|\n/g).join("").replace(/ /g,"").split("");$("#rowWidth").html();a(parseInt($("#chessboard tr td.bluePlayer").attr("data-pos")),parseInt(e.attr("data-pos")),t)}function a(e,t,s){s[e-1]="0",s[t-1]="B",$("#chessboardInput").val(s.join("")),$('#chessboard tr td[data-pos="'+e+'"]').removeClass("bluePlayer"),$("#chessboard tr td").removeClass("movableGreenSpaces"),$('#chessboard tr td[data-pos="'+t+'"]').addClass("bluePlayer");e-t==parseInt($("#rowWidth").html())?r("D"):e-t==-parseInt($("#rowWidth").html())?r("U"):e-t==1?r("R"):e-t==-1&&r("L")}function r(s){var a=$("#chessboardInput").val();a=a.split(/\r\n|\r|\n/g).join("").replace(/ /g,"").split("");var r=parseInt($("#rowWidth").html()),l=$("#chessboard tr td.redPlayer").attr("data-pos"),n=-1;"D"==s?(n=parseInt(l)+parseInt($("#rowWidth").html()),n>a.length&&(n=-1)):"U"==s?(n=parseInt(l)-parseInt($("#rowWidth").html()),1>n&&(n=-1)):"R"==s?(n=parseInt(l)+1,l%r==0&&(n=-1)):"L"==s&&(n=parseInt(l)-1,l%r==1&&(n=-1)),-1==n||"x"!=a[n-1]&&"B"!=a[n-1]&&"R"!=a[n-1]||(n=-1),-1!=n&&(a[l-1]="0",a[n-1]="R",$("#chessboardInput").val(a.join("")),$('#chessboard tr td[data-pos="'+l+'"]').removeClass("redPlayer"),$('#chessboard tr td[data-pos="'+n+'"]').addClass("redPlayer")),o(),t($("#chessboard tr td.redPlayer").attr("data-pos"),a,r,"R"),t($("#chessboard tr td.bluePlayer").attr("data-pos"),a,r,"B"),e($("#chessboard tr td.bluePlayer").attr("data-pos"),a,r)}function o(){$("#chessboard tr td.redPlayer").attr("data-pos")==$("#chessboard tr td.firstBP").attr("data-pos")&&$("#chessboard tr td.bluePlayer").attr("data-pos")==$("#chessboard tr td.firstRP").attr("data-pos")&&((b<storage.getItem(u)||0==storage.getItem(u))&&storage.setItem(u,b),$("#win p span").html(b),$("#win").show())}function l(e){"h"==e?window.location.href="howtoplay.html":setTimeout(function(){window.location.href="level_"+e+".html"},1200)}function n(e){(0==storage.getItem("changeLevel")||storage.getItem("highestLevel")<e)&&storage.setItem("highestLevel",e)}var h=[10,14,20,13,10,14,15,14,25,10,9,9,14,25,17,20,13,17,14,15,19,11,17,16,14,12,15,12,13,15,21],c="<p class='each_level' data-lvl='0' style='color:#a9a9a9;'>Intro</p>";if(0!=storage.getItem("highestLevel"))for(var d=1;d<=parseInt(storage.getItem("highestLevel"));d++){var i="stepsLevel_"+d,v="";null==storage.getItem(i)&&storage.setItem(i,0),v=storage.getItem(i)==h[d-1]?"green_color":0==storage.getItem(i)?"no_color":"red_color";var g="<span class='stats'>Your solution: <span class='"+v+"'>"+storage.getItem(i)+"</span> | Fastest possible: <span class='"+v+"'>"+h[d-1]+"</span></span>";c+="<p class='each_level' data-lvl='"+d+"'>Level "+d+" <span></span>"+g+"</p>"}if($("#browselevels").html(c+"<p class='close_levels'>Close</p>"),$("#userSteps").html(storage.getItem(u)),$(".fastest").html(h[checkLvl-1]),11==checkLvl){for(var p=0,d=1;d<=h.length;d++){var i="stepsLevel_"+d;h[d-1]==storage.getItem(i)&&p++}4>p&&($("#showReqs").show(),$("#chessboard tr td.bluePlayer").hide(),$("#chessboard tr td.redPlayer").hide())}if(21==checkLvl){for(var p=0,d=1;d<=h.length;d++){var i="stepsLevel_"+d;h[d-1]==storage.getItem(i)&&p++}12>p&&($("#showReqs_21").show(),$("#chessboard tr td.bluePlayer").hide(),$("#chessboard tr td.redPlayer").hide())}if(31==checkLvl){for(var p=0,d=1;d<=h.length;d++){var i="stepsLevel_"+d;h[d-1]==storage.getItem(i)&&p++}26>p&&($("#showReqs_31").show(),$("#chessboard tr td.bluePlayer").hide(),$("#chessboard tr td.redPlayer").hide(),$("#chessboard tr td.teleBox").hide())}var b=0,m=$("#chessboard tr td.bluePlayer").attr("data-pos");e(m,currentBoard,parseInt($("#rowWidth").html())),$("#chessboard").on(browserTesting,".movableGreenSpaces",function(){b++,$(".curSteps").html(b);var e=$("#chessboardInput").val();e=e.split(/\r\n|\r|\n/g).join("").replace(/ /g,"").split("");$("#rowWidth").html();a(parseInt($("#chessboard tr td.bluePlayer").attr("data-pos")),parseInt($(this).attr("data-pos")),e)}),$("#chessboard").on("swipeRight",".bluePlayer",function(){var e=parseInt($(this).attr("data-pos")),t=$("#chessboard td[data-pos='"+(e+1)+"']");t.hasClass("movableGreenSpaces")&&s(t)}),$("#chessboard").on("swipeLeft",".bluePlayer",function(){var e=parseInt($(this).attr("data-pos")),t=$("#chessboard td[data-pos='"+(e-1)+"']");t.hasClass("movableGreenSpaces")&&s(t)}),$("#chessboard").on("swipeUp",".bluePlayer",function(){var e=parseInt($(this).attr("data-pos")),t=parseInt($("#rowWidth").html()),a=$("#chessboard td[data-pos='"+(e-t)+"']");a.hasClass("movableGreenSpaces")&&s(a)}),$("#chessboard").on("swipeDown",".bluePlayer",function(){var e=parseInt($(this).attr("data-pos")),t=parseInt($("#rowWidth").html()),a=$("#chessboard td[data-pos='"+(e+t)+"']");a.hasClass("movableGreenSpaces")&&s(a)}),$(".resetbutton").on(browserTesting,function(){window.location.href=window.location.href}),$(".browsebutton").on(browserTesting,function(){setTimeout(function(){$("#browselevels").show()},300)}),$(".close_levels").on(browserTesting,function(){$("#browselevels").hide()}),$(".each_level").on("click",function(){var e=$(this).attr("data-lvl");storage.setItem("changeLevel",1),window.location.href=0==e?"index.html":"level_"+e+".html"}),$(".win_index .playagain").on(browserTesting,function(){n(0),window.location.href=window.location.href}),$(".win_index .nextlevel").on(browserTesting,function(){n(0),l("h")}),$(".win_howto .playagain").on(browserTesting,function(){n(1),l("h")}),$(".win_howto .nextlevel").on(browserTesting,function(){n(1),l(1)}),isNaN(checkLvl.trim())||(checkLvl=parseInt(checkLvl),$(".win_level"+checkLvl+" .playagain").on(browserTesting,function(){31!=checkLvl&&n(checkLvl+1),l(checkLvl)}),$(".win_level"+checkLvl+" .nextlevel").on(browserTesting,function(){31!=checkLvl&&(n(checkLvl+1),l(checkLvl+1))}))});